EAPI=6

DESCRIPTION="OpenCL tool to detect buffer overflows in GPU kernels "
HOMEPAGE="https://github.com/ROCm-Developer-Tools/clARMOR"
SRC_URI="https://github.com/ROCm-Developer-Tools/${PN}/archive/${PV}.tar.gz -> ${P}.tar.gz"

LICENSE=""
SLOT="0"
KEYWORDS="~amd64"
IUSE=""

DEPEND=""
RDEPEND="" # "rocm-opencl-runtime"

#src_unpack() {
#	unpack ${A}
#	mv ROC-smi-roc-${PV} rocm-smi-${PV}
#}

src_configure() {
	export OCL_INCLUDE_DIR=/usr/include/CL
	export OCL_LIB_DIR=/usr/lib64
#	export OCL_ICD_VENDORS=amdocl64.icd
#	AMDAPPSDKROOT
#	ATISTREAMSDKROOT
#	INTELOCLSDKROOT
#	CUDA_INC_PATH
#	CUDA_LIB_PATH
#	CUDA_PATH
	default
}

src_compile() {
	default
	pushd tests/good_cl_mem die
	make build_test
	popd || die
}

#src_install() {
#	exeinto /opt/rocm/bin
#	doexe ${S}/rocm_smi.py
#	dosym ./rocm_smi.py /opt/rocm/bin/rocm-smi
#}
